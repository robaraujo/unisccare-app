{"version":3,"sources":["../../src/pages/partials/modal-camera-gallery/modal-camera-gallery.module.ts","../../src/helpers/shared.module.ts","../../src/components/progress-bar/progress-bar.ts","../../src/pages/partials/modal-camera-gallery/modal-camera-gallery.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAAyC;AACO;AACgB;AACA;AAchE;IAAA;IAAiD,CAAC;IAArC,kCAAkC;QAZ9C,+DAAQ,CAAC;YACR,YAAY,EAAE;gBACZ,qFAAsB;aACvB;YACD,OAAO,EAAE;gBACP,8DAAe,CAAC,QAAQ,CAAC,qFAAsB,CAAC;gBAChD,4EAAY;aACb;YACD,eAAe,EAAE;gBACf,qFAAsB;aACvB;SACF,CAAC;OACW,kCAAkC,CAAG;IAAD,yCAAC;CAAA;AAAH;;;;;;;;;;;;;;;;;;;;;ACjBN;AACI;AACH;AACmC;AACzB;AAYpD;IAAA;IAA2B,CAAC;IAAf,YAAY;QAVxB,+DAAQ,CAAC;YACN,OAAO,EAAE;gBACL,6DAAY;gBACZ,0DAAW;gBACX,4EAAe,CAAC,QAAQ,EAAE;aAC7B;YACD,YAAY,EAAE,CAAC,mGAAoB,CAAC;YACpC,OAAO,EAAE,CAAC,mGAAoB,EAAE,4EAAe,CAAC;SACnD,CAAC;OAEW,YAAY,CAAG;IAAD,mBAAC;CAAA;AAAH;;;;;;;;;;;;;;;;;;;;AChBwB;AAMjD;IAIE;IAEA,CAAC;IAJkB;QAAlB,4DAAK,CAAC,UAAU,CAAC;;0DAAU;IAFjB,oBAAoB;QAJhC,gEAAS,CAAC;YACT,QAAQ,EAAE,cAAc;WACQ;SACjC,CAAC;;OACW,oBAAoB,CAQhC;IAAD,CAAC;AAAA;SARY,oBAAoB,W;;;;;;;;;;;;;;;;;;;;;;;;;;;ACNS;AACoB;AACD;AACnB;AACiB;AACA;AACV;AACiD;AACrD;AACiB;AAO9D;IAKI,gCAAoB,QAAwB,EACzB,OAAsB,EACrB,MAAc,EACd,QAAkB,EAClB,IAAU,EACV,YAA0B,EAC1B,QAAsB,EACtB,MAAc,EACd,WAA8B,EAC9B,WAAwB;QAT5C,iBAgBC;QAhBmB,aAAQ,GAAR,QAAQ,CAAgB;QACzB,YAAO,GAAP,OAAO,CAAe;QACrB,WAAM,GAAN,MAAM,CAAQ;QACd,aAAQ,GAAR,QAAQ,CAAU;QAClB,SAAI,GAAJ,IAAI,CAAM;QACV,iBAAY,GAAZ,YAAY,CAAc;QAC1B,aAAQ,GAAR,QAAQ,CAAc;QACtB,WAAM,GAAN,MAAM,CAAQ;QACd,gBAAW,GAAX,WAAW,CAAmB;QAC9B,gBAAW,GAAX,WAAW,CAAa;QAXpC,kBAAa,GAAU,gBAAgB,CAAC;QAe5C,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC,aAAG;YAC1B,KAAI,CAAC,YAAY,GAAG,KAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;QAC/C,CAAC,CAAC,CAAC;IACP,CAAC;IAED;;;OAGG;IACH,wCAAO,GAAP,UAAQ,IAAa;QACjB,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;IAChC,CAAC;IAED;;;OAGG;IACH,wCAAO,GAAP,UAAQ,IAAI;QAAZ,iBAgCC;QA9BG,IAAI,OAAO,GAAG;YACV,OAAO,EAAE,CAAC;YACV,MAAM,EAAE,CAAC;SACZ,CAAC;QAGF,sBAAsB;QACtB,EAAE,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,SAAS,CAAC;YAAC,MAAM,CAAC;QAExC,IAAM,OAAO,GAAkB;YAC3B,OAAO,EAAE,EAAE;YACX,kBAAkB,EAAE,IAAI;YACxB,UAAU,EAAE,OAAO,CAAC,IAAI,CAAC;YACzB,eAAe,EAAE,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,QAAQ;YACrD,YAAY,EAAE,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,IAAI;YAC3C,SAAS,EAAE,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,OAAO;SAC3C,CAAC;QAEF,4BAA4B;QAC5B,EAAE,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;YAC1B,OAAO,CAAC,SAAS,GAAG,IAAI,CAAC;QAC7B,CAAC;QAED,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,IAAI,CAChC,cAAI,IAAG,YAAI,CAAC,MAAM,CAAC,IAAI,CAAC,EAAjB,CAAiB,EACxB,eAAK;YACD,6CAA6C;YAC7C,2DAA2D;QAC/D,CAAC,CACJ,CAAC;IACN,CAAC;IAED;;;OAGG;IACH,uCAAM,GAAN,UAAO,OAAO;QAAd,iBAcC;QAbG,IAAI,CAAC,IAAI;aACJ,IAAI,CAAC,OAAO,EAAE,EAAC,OAAO,EAAE,GAAG,EAAC,CAAC;aAC7B,IAAI,CACD,kBAAQ,IAAI,YAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,EAAvB,CAAuB,EACnC,eAAK;YACD,EAAE,CAAC,CAAC,KAAK,IAAI,KAAK,CAAC,IAAI,IAAI,KAAK,CAAC,IAAI,KAAK,eAAe,CAAC,CAAC,CAAC;gBACxD,MAAM,CAAC,KAAI,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC;YACpC,CAAC;YAED,KAAI,CAAC,MAAM,CAAC,OAAO,CAAC,uBAAuB,EAAE,OAAO,CAAC,CAAC;YACtD,KAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;QAC1B,CAAC,CACJ,CAAC;IACV,CAAC;IAED;;;OAGG;IACH,yCAAQ,GAAR,UAAS,OAAO;QAAhB,iBAkBC;QAhBG,IAAI,OAAO,GAAG;YACV,GAAG,EAAE,OAAO;YACZ,UAAU,EAAE,QAAQ;YACpB,QAAQ,EAAE,uBAAuB;YACjC,OAAO,EAAE,GAAG;YACZ,KAAK,EAAE,GAAG;YACV,MAAM,EAAE,GAAG;SACd,CAAC;QAEF,IAAI,CAAC,YAAY;aACZ,MAAM,CAAC,OAAO,CAAC;aACf,IAAI,CAAC,UAAC,QAAgB,IAAK,YAAI,CAAC,UAAU,CAAC,OAAO,CAAC,EAAxB,CAAwB,CAAC;aACpD,KAAK,CAAC,WAAC;YACJ,KAAI,CAAC,MAAM,CAAC,OAAO,CAAC,+BAA+B,EAAE,OAAO,CAAC,CAAC;YAC9D,KAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;QAC1B,CAAC,CAAC,CAAC;IACX,CAAC;IAGD;;;OAGG;IACH,2CAAU,GAAV,UAAW,OAAO;QAAlB,iBA+BC;QA7BG,IAAI,MAAM,GAAG,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,EAAE,OAAO,EAAE,IAAI,CAAC,aAAa,EAAE,CAAC,CAAC;QACtE,MAAM,CAAC,OAAO,EAAE,CAAC;QAEjB,IAAI,OAAO,GAAsB;YAC7B,OAAO,EAAE,MAAM;YACf,QAAQ,EAAE,YAAY;YACtB,OAAO,EAAE,EAAC,eAAe,EAAE,SAAS,GAAC,IAAI,CAAC,WAAW,CAAC,OAAO,EAAC;SACjE,CAAC;QAEF,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,OAAO,EAAE,2DAAM,CAAC,MAAM,GAAG,eAAe,EAAE,OAAO,CAAC;aACtE,IAAI,CACD,UAAC,IAAS;YACN,MAAM,CAAC,OAAO,EAAE,CAAC;YAEjB,EAAE,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,YAAY,KAAK,GAAG,CAAC,CAAC,CAAC;gBAC3D,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;gBACpB,KAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;gBACtB,KAAI,CAAC,MAAM,CAAC,OAAO,CAAC,uCAAuC,EAAE,OAAO,CAAC,CAAC;YAC1E,CAAC;YAED,KAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;YACnB,KAAI,CAAC,MAAM,CAAC,OAAO,CAAC,6BAA6B,EAAE,SAAS,CAAC,CAAC;QAClE,CAAC,EACD,UAAC,GAAG;YACA,MAAM,CAAC,OAAO,EAAE,CAAC;YACjB,KAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;YACtB,KAAI,CAAC,MAAM,CAAC,OAAO,CAAC,uCAAuC,EAAE,OAAO,CAAC,CAAC;QAC1E,CAAC,CACJ,CAAC;IACV,CAAC;IArJQ,sBAAsB;QAJlC,gEAAS,CAAC;YACT,QAAQ,EAAE,sBAAsB;WACU;SAC3C,CAAC;yEAM8C;YAChB,qEAAa;YACb,uDAAM;YACJ,iEAAQ;YACZ,iFAAI;YACI,iFAAY;YAChB,gEAAY;YACd,gEAAM;YACD,8EAAiB;YACjB,WAAW;OAdnC,sBAAsB,CAsJlC;IAAD,CAAC;AAAA;SAtJY,sBAAsB,iB","file":"9.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { ModalCameraGalleryPage } from './modal-camera-gallery';\nimport { SharedModule } from './../../../helpers/shared.module';\n\n@NgModule({\n  declarations: [\n    ModalCameraGalleryPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(ModalCameraGalleryPage),\n    SharedModule\n  ],\n  entryComponents: [\n    ModalCameraGalleryPage\n  ]\n})\nexport class ModalChooseCameraGalleryPageModule {}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/partials/modal-camera-gallery/modal-camera-gallery.module.ts","import { NgModule } from '@angular/core';\nimport {CommonModule} from '@angular/common'; \nimport {IonicModule} from 'ionic-angular';\nimport {ProgressBarComponent} from '../components/progress-bar/progress-bar';\nimport {TranslateModule} from '@ngx-translate/core';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        IonicModule,\n        TranslateModule.forChild()\n    ],\n    declarations: [ProgressBarComponent],\n    exports: [ProgressBarComponent, TranslateModule],\n})\n\nexport class SharedModule {}\n\n\n// WEBPACK FOOTER //\n// ./src/helpers/shared.module.ts","import { Component, Input } from '@angular/core';\n \n@Component({\n  selector: 'progress-bar',\n  templateUrl: 'progress-bar.html'\n})\nexport class ProgressBarComponent {\n \n  @Input('progress') progress;\n \n  constructor() {\n \n  }\n \n}\n\n\n// WEBPACK FOOTER //\n// ./src/components/progress-bar/progress-bar.ts","import { Component } from '@angular/core';\nimport { ViewController, IonicPage, NavController } from 'ionic-angular';\nimport { Camera, CameraOptions } from '@ionic-native/camera';\nimport { Crop } from '@ionic-native/crop';\nimport { ImageResizer } from '@ionic-native/image-resizer';\nimport { Platform, LoadingController} from 'ionic-angular';\nimport { Global } from '../../../helpers/global';\nimport { FileTransfer, FileUploadOptions, FileTransferObject } from '@ionic-native/file-transfer';\nimport { config } from '../../../app/config';\nimport { UserService } from '../../../providers/user-service';\n\n@IonicPage({\n    name: 'modal-camera-gallery',\n    segment: 'modal-camera-gallery'\n})\n@Component({\n  selector: 'modal-camera-gallery',\n  templateUrl: './modal-camera-gallery.html'\n})\nexport class ModalCameraGalleryPage {\n    \n    private fileTransfer: FileTransferObject;\n    private uploadingText:string = 'Fazendo upload';\n    \n    constructor(private viewCtrl: ViewController,\n                public navCtrl: NavController,\n                private camera: Camera,\n                private platform: Platform,\n                private crop: Crop,\n                private imageResizer: ImageResizer,\n                private transfer: FileTransfer,\n                private global: Global,\n                private loadingCtrl: LoadingController,\n                private userService: UserService,\n            \n            ) {\n\n        this.platform.ready().then(res => {\n            this.fileTransfer = this.transfer.create();\n        });\n    }\n\n    /**\n     * Close modal and return user choose\n     * @param type type that user choose(camera, gallery, cancel)\n     */\n    dismiss(type?: string) {\n        this.viewCtrl.dismiss(type);\n    }\n\n    /**\n     * Callback from ModalCameraGallery\n     * @param type string[gallery,camera, remove, undefined]\n     */\n    takePic(type) {\n\n        let sources = {\n            gallery: 0,\n            camera: 1,\n        };\n\n\n        // source type invalid\n        if (sources[type] === undefined) return;\n        \n        const options: CameraOptions = {\n            quality: 80,\n            correctOrientation: true,            \n            sourceType: sources[type],\n            destinationType: this.camera.DestinationType.FILE_URI,\n            encodingType: this.camera.EncodingType.JPEG,\n            mediaType: this.camera.MediaType.PICTURE\n        };\n\n        // fix ios bug when cropping\n        if (this.platform.is('ios')) {\n            options.allowEdit = true;\n        }\n\n        this.camera.getPicture(options).then(\n            file=> this.doCrop(file),\n            error=> {\n                // Selection cancelled && 'Camera cancelled.'\n                //this.error('ProfilePage.takePic', 'Error getting image.')\n            }\n        );\n    }\n\n    /**\n     * Let user crop image\n     * @param fileUri string\n     */\n    doCrop(fileUri) {\n        this.crop\n            .crop(fileUri, {quality: 100})\n            .then(\n                newImage => this.doResize(newImage),\n                error => {\n                    if (error && error.code && error.code === 'userCancelled') {\n                        return this.dismiss('canceled');\n                    }\n\n                    this.global.showMsg('Error cropping image.', 'error');\n                    this.dismiss('error');\n                }\n            );\n    }\n\n    /**\n     * Resize image to 200x200\n     * @param fileUri string\n     */\n    doResize(fileUri) {\n\n        let options = {\n            uri: fileUri,\n            folderName: 'avatar',\n            fileName: 'localdrive-avatar.jpg',            \n            quality: 100,\n            width: 500,\n            height: 500\n        };\n           \n        this.imageResizer\n            .resize(options)\n            .then((filePath: string) => this.saveAvatar(fileUri))\n            .catch(e => {\n                this.global.showMsg('Erro ao redimensionar imagem.', 'error');\n                this.dismiss('error');\n            });\n    }\n\n    \n    /**\n     * Access server to save avatar\n     * @param base64File string\n     */\n    saveAvatar(fileUri) {\n        \n        let loader = this.loadingCtrl.create({ content: this.uploadingText });\n        loader.present();\n\n        let options: FileUploadOptions = {\n            fileKey: 'file',\n            fileName: 'avatar.jpg',\n            headers: {'Authorization': 'Bearer '+this.userService.idToken}\n        };\n        \n        this.fileTransfer.upload(fileUri, config.apiUrl + '/photos/store', options)\n            .then(\n                (resp: any) => {\n                    loader.dismiss();\n\n                    if (!resp || !resp.responseCode || resp.responseCode !== 200) {\n                        console.error(resp);\n                        this.dismiss('error');\n                        this.global.showMsg('Erro ao enviar imagem para o servidor', 'error');\n                    }\n                    \n                    this.dismiss(resp);\n                    this.global.showMsg('Imagem enviada com sucesso.', 'success');\n                },\n                (err) => {\n                    loader.dismiss();\n                    this.dismiss('error');\n                    this.global.showMsg('Erro ao enviar imagem para o servidor', 'error');\n                } \n            );\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/partials/modal-camera-gallery/modal-camera-gallery.ts"],"sourceRoot":""}